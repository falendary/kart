!function t(e,o,r){function n(l,a){if(!o[l]){if(!e[l]){var s="function"==typeof require&&require;if(!a&&s)return s(l,!0);if(i)return i(l,!0);var c=new Error("Cannot find module '"+l+"'");throw c.code="MODULE_NOT_FOUND",c}var u=o[l]={exports:{}};e[l][0].call(u.exports,function(t){var o=e[l][1][t];return n(o?o:t)},u,u.exports,t,e,o,r)}return o[l].exports}for(var i="function"==typeof require&&require,l=0;l<r.length;l++)n(r[l]);return n}({1:[function(t,e,o){"use strict";var r=function(){function t(t,e){t.state("app",{url:"/app","abstract":!0,templateUrl:"views/shell.html",controller:"ShellController as vm"}).state("app.main",{url:"/main",templateUrl:"views/main.html",controller:"MainController as vm"}).state("app.products",{url:"/products",templateUrl:"views/products.html",controller:"ProductsController as vm"}).state("app.product",{url:"/products/:itemId",templateUrl:"views/product.html",controller:"ProductsDetailsController as vm"}).state("app.product-add",{url:"/add/product",templateUrl:"views/product-add.html",controller:"ProductsAddController as vm"}).state("app.reports",{url:"/reports",templateUrl:"views/reports.html",controller:"ReportsController as vm"}).state("app.bills",{url:"/bills",templateUrl:"views/bills-dashboard.html",controller:"BillsDashboardController as vm"}).state("app.bills-add",{url:"/add/bill",templateUrl:"views/bills-add.html",controller:"BillsAddController as vm"}).state("app.stats",{url:"/stats",templateUrl:"views/stats.html",controller:"StatsController as vm"}).state("app.settings",{url:"/settings",templateUrl:"views/settings.html",controller:"SettingsController as vm"}),console.log("Router initialized..."),e.otherwise("/app/main")}return t}();o.Routes=r},{}],2:[function(t,e,o){"use strict";var r=function(){function t(t){this.scope=t,t.$on("$destroy",this.onDestroy),t.$on("$apply",this.apply)}return t.prototype.apply=function(){this.scope.$apply()},t.prototype.onDestroy=function(){return void console.log("Controller destroyed")},t}();o.BaseController=r},{}],3:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Bills add controller initialized...")}return t}();o.BillsAddController=r},{}],4:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Bills dashboard controller initialized...")}return t}();o.BillsDashboardController=r},{}],5:[function(t,e,o){var r=function(){function t(){console.log("Bills shell controller initialized...")}return t}();o.BillsShellController=r},{}],6:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Main controller initialized...")}return t}();o.MainController=r},{}],7:[function(t,e,o){var r=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=t("./BaseController"),i=t("../services/CategoriesService"),l=t("../services/ProductsService"),a=function(t){function e(e,o){var r=this;t.call(this,e),this.categoriesService=new i.CategoriesService,this.productsService=new l.ProductsService,this.setCategory=function(t){r.item.category=JSON.parse(JSON.stringify(t)),r.categoriesAutoComplete=[]},console.log("Item add controller..."),this.state=o,this.getCategories()}return r(e,t),e.prototype.getCategories=function(){var t=this;this.categoriesService.getList().then(function(e){t.categories=e,console.log("this.categories",t.categories),t.apply()})},e.prototype.categorySearch=function(){var t=this;""!==this.item.category.categoryName?this.categoriesService.searchCategory(this.item.category.categoryName,this.categories).then(function(e){t.categoriesAutoComplete=e,t.apply()}):this.categoriesAutoComplete=[]},e.prototype.addProduct=function(){var t=this;console.log("Product add controller, item",this.item),this.productsService.add(this.item).then(function(e){console.log("Product add controller, add response: ",e),t.categoriesService.addProduct(t.item.category._id,t.item).then(function(e){console.log("Product add controller, addProduct response: ",e),t.item=null,t.categoriesAutoComplete=[],console.log("work?"),e.ok&&(console.log("then",e),t.state.go("app.products"))})})},e}(n.BaseController);o.ProductsAddController=a},{"../services/CategoriesService":19,"../services/ProductsService":21,"./BaseController":2}],8:[function(t,e,o){var r=this&&this.__extends||function(t,e){function o(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)},n=t("../services/CategoriesService"),i=t("./BaseController"),l=function(t){function e(e){var o=this;t.call(this,e),this.categoriesService=new n.CategoriesService,this.categories=[],console.log("Products controller initialized..."),this.categoriesService.getList().then(function(t){o.categories=t,console.log("this.categories",o.categories),o.apply()}),console.log("$scope",e),console.log("this",this)}return r(e,t),e.prototype.toggleCategory=function(t){this.isCategoryShown(t)?this.shownCategory=null:this.shownCategory=t},e.prototype.isCategoryShown=function(t){return this.shownCategory===t},e}(i.BaseController);o.ProductsController=l},{"../services/CategoriesService":19,"./BaseController":2}],9:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Item controller initialized...")}return t}();o.ProductsDetailsController=r},{}],10:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Reports controller initialized...")}return t}();o.ReportsController=r},{}],11:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Settings controller initialized...")}return t}();o.SettingsController=r},{}],12:[function(t,e,o){"use strict";var r=function(){function t(t){console.log("Shell controller initialized...")}return t}();o.ShellController=r},{}],13:[function(t,e,o){"use strict";var r=function(){function t(){console.log("Stats controller initialized...")}return t}();o.StatsController=r},{}],14:[function(t,e,o){var r=function(){function t(){}return t.prototype.deserialize=function(t){return this._id=t._id,this._rev=t._rev,this.id=t.id,this.categoryName=t.categoryName,this.keyName=t.keyName,this.products=t.products,this},t}();o.Category=r},{}],15:[function(t,e,o){var r=function(){function t(){}return t.prototype.deserialize=function(t){return this.id=t.id,this._id=t._id,this._rev=t._rev,this.ok=t.ok,this.error=t.error,this},t}();o.Response=r},{}],16:[function(t,e,o){var r=t("../models/CategoryModel"),n=t("../models/ResponseModel"),i=function(){function t(){}return t.prototype.getList=function(t,e){var o=[];return new Promise(function(t){window.kart.db.query(function(t,e){t.categoryName&&e(t)},{type:"category",include_docs:!0}).then(function(e){o=e.rows.map(function(t){return(new r.Category).deserialize(t.doc)}),t(o)})})},t.prototype.getByKey=function(t){return void 0},t.prototype.add=function(t){return void 0},t.prototype.update=function(t,e){return void 0},t.prototype["delete"]=function(t){return void 0},t.prototype.addProduct=function(t,e){return new Promise(function(o,r){return window.kart.db.get(t).then(function(r){return r.products?r.products.push(e):r.products=[e],window.kart.db.put({_id:t,_rev:r._rev,categoryName:r.categoryName,keyName:r.keyName,products:r.products}).then(function(t){return o((new n.Response).deserialize(t))})})})},t}();o.CategoriesRepository=i},{"../models/CategoryModel":14,"../models/ResponseModel":15}],17:[function(t,e,o){var r=function(){function t(){}return t.prototype.createCategories=function(){var t,e=[{id:1,name:"Овощи",keyName:"vegetables"},{id:2,name:"Фрукты и ягоды",keyName:"fruit"},{id:3,name:"Грибы",keyName:"mushrooms"},{id:4,name:"Яйца и молочные продукты",keyName:"eggs"},{id:5,name:"Мясные продукты",keyName:"meat"},{id:6,name:"Рыба и морепродукты",keyName:"fish"},{id:7,name:"Орехи и сухофрукты",keyName:"nuts"},{id:8,name:"Мука и мучные изделия",keyName:"baking"},{id:9,name:"Крупы и каши",keyName:"cereals"},{id:10,name:"Кондитерские изделия",keyName:"confectionery"},{id:11,name:"Специи и пряности",keyName:"spices"},{id:12,name:"Безалкогольные напитки",keyName:"softDrinks"},{id:13,name:"Алкогольные напитки",keyName:"alcohol"},{id:14,name:"Сырье и добавки",keyName:"rawMaterials"}];for(t=0;t<e.length;t+=1)window.kart.db.put({_id:"category"+t,categoryName:e[t].name,keyName:e[t].keyName,type:"category"})},t.prototype.createProducts=function(){},t}();o.InitDatabaseRepository=r},{}],18:[function(t,e,o){var r=t("../models/ResponseModel"),n=function(){function t(){}return t.prototype.getList=function(){return void 0},t.prototype.getByKey=function(t){return void 0},t.prototype.add=function(t){return window.kart.db.put({_id:"product"+(new Date).getTime(),productName:t.productName,category:t.category,type:"product"}).then(function(t){return(new r.Response).deserialize(t)})},t.prototype.update=function(t,e){return void 0},t.prototype["delete"]=function(t){return void 0},t}();o.ProductsRepository=n},{"../models/ResponseModel":15}],19:[function(t,e,o){var r=t("../repositories/CategoriesRepository"),n=function(){function t(){this.categoriesRepository=new r.CategoriesRepository}return t.prototype.getList=function(){return this.categoriesRepository.getList()},t.prototype.getByKey=function(t){return this.categoriesRepository.getByKey(t)},t.prototype.add=function(t){return this.categoriesRepository.add(t)},t.prototype.update=function(t,e){return this.categoriesRepository.update(t,e)},t.prototype["delete"]=function(t){return this.categoriesRepository["delete"](t)},t.prototype.searchCategory=function(t,e){return new Promise(function(o,r){var n=e.filter(function(e){return-1!==e.categoryName.toLowerCase().indexOf(t.toLowerCase())?!0:void 0});setTimeout(function(){o(n)},100)})},t.prototype.addProduct=function(t,e){return this.categoriesRepository.addProduct(t,e)},t}();o.CategoriesService=n},{"../repositories/CategoriesRepository":16}],20:[function(t,e,o){var r=t("../repositories/InitDatabaseRepository"),n=function(){function t(t){this.initDatabaseRepository=new r.InitDatabaseRepository,this.db=null,this.cordovaSQlite=t}return t}();o.DatabaseService=n},{"../repositories/InitDatabaseRepository":17}],21:[function(t,e,o){var r=t("../repositories/ProductsRepository"),n=function(){function t(){this.productsRepository=new r.ProductsRepository}return t.prototype.getList=function(){return this.productsRepository.getList()},t.prototype.getByKey=function(t){return this.productsRepository.getByKey(t)},t.prototype.add=function(t){return this.productsRepository.add(t)},t.prototype.update=function(t,e){return this.productsRepository.update(t,e)},t.prototype["delete"]=function(t){return this.productsRepository["delete"](t)},t}();o.ProductsService=n},{"../repositories/ProductsRepository":18}],22:[function(t,e,o){var r=t("./app/Routes"),n=t("./app/controllers/MainController"),i=t("./app/controllers/ShellController"),l=t("./app/repositories/InitDatabaseRepository"),a=t("./app/services/DatabaseService"),s=t("./app/controllers/ReportsController"),c=t("./app/controllers/StatsController"),u=t("./app/controllers/SettingsController"),p=t("./app/controllers/ProductsController"),d=t("./app/controllers/ProductsDetailsController"),m=t("./app/controllers/ProductsAddController"),v=t("./app/controllers/BillsShellController"),g=t("./app/controllers/BillsDashboardController"),y=t("./app/controllers/BillsAddController"),h=angular.module("app",["ionic","ngCordova"]);h.config(["$stateProvider","$urlRouterProvider",r.Routes]),h.run([function(){console.log("App initialized..."),window.kart=window.kart||{},window.kart.db=new PouchDB("kart",{adapter:"websql"});var t=new l.InitDatabaseRepository;t.createCategories(),t.createProducts(),console.log("window.kart.db",window.kart.db)}]),h.service("Database",["$cordovaSQLite",a.DatabaseService]),h.controller("ShellController",["$scope",i.ShellController]),h.controller("MainController",["$scope",n.MainController]),h.controller("ReportsController",["$scope",s.ReportsController]),h.controller("StatsController",["$scope",c.StatsController]),h.controller("SettingsController",["$scope",u.SettingsController]),h.controller("ProductsController",["$scope",p.ProductsController]),h.controller("ProductsDetailsController",["$scope",d.ProductsDetailsController]),h.controller("ProductsAddController",["$scope","$state",m.ProductsAddController]),h.controller("BillsShellController",["$scope",v.BillsShellController]),h.controller("BillsDashboardController",["$scope",g.BillsDashboardController]),h.controller("BillsAddController",["$scope",y.BillsAddController]),t("./templates.min.js")},{"./app/Routes":1,"./app/controllers/BillsAddController":3,"./app/controllers/BillsDashboardController":4,"./app/controllers/BillsShellController":5,"./app/controllers/MainController":6,"./app/controllers/ProductsAddController":7,"./app/controllers/ProductsController":8,"./app/controllers/ProductsDetailsController":9,"./app/controllers/ReportsController":10,"./app/controllers/SettingsController":11,"./app/controllers/ShellController":12,"./app/controllers/StatsController":13,"./app/repositories/InitDatabaseRepository":17,"./app/services/DatabaseService":20,"./templates.min.js":23}],23:[function(t,e,o){!function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/bills-add.html",'<ion-view view-title="Новый чек"><ion-content><div class="bill-header"><div class="row"><div class="col-10 bill-column"></div><div class="col-50 bill-column">Название</div><div class="col-20 bill-column text-center">Цена<br>1 шт.</div><div class="col-10 bill-column">Кол.</div><div class="col-10 bill-column">Итог</div></div></div><div class="bill-body"><div class="item row"><div class="col-10 bill-column"><a href="" data-ng-click="vm.addField()"><i class="ion-plus-circled"></i></a></div><div class="col-50 bill-column"><input type="text" placeholder=""></div><div class="col-20 bill-column"><input type="text" placeholder="" class="text-center"></div><div class="col-10 bill-column"><input type="text" placeholder="" class="text-center"></div><div class="col-10 bill-column"><input type="text" placeholder="" class="text-center"></div></div></div></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/bills-dashboard.html",'<ion-view view-title="Чеки"><ion-content><button data-ui-sref="app.bills-add" class="button">Добавить чек</button></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/main.html",'<ion-view view-title="Главная"><ion-content><h1>Главная</h1></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/product-add.html",'<ion-view view-title="Новый товар"><ion-content><div class="list list-inset"><label class="item item-input"><input type="text" placeholder="Название товара" data-ng-model="vm.item.productName"></label><label class="item item-input"><input type="search" placeholder="Категория товара" data-ng-model="vm.item.category.categoryName" data-ng-change="vm.categorySearch()"></label></div><div class="list"><li class="item" data-ng-repeat="category in vm.categoriesAutoComplete" data-ng-bind="::category.categoryName" data-ng-click="vm.setCategory(category)"></li></div><button class="button" style="float: right; margin-right: .6em" data-ng-click="vm.addProduct()">Добавить</button></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/product.html",'<ion-view view-title="{{\'Имя товара\'}}"><ion-content><ion-list><ion-item ng-repeat="playlist in playlists" href="#/app/playlists/{{playlist.id}}">{{playlist.title}}</ion-item></ion-list></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/products.html",'<ion-view><ion-content><ion-list><button data-ui-sref="app.product-add" class="button">Добавить товар</button><div data-ng-repeat="category in vm.categories"><ion-item class="item-stable" data-ng-click="vm.toggleCategory(category)" data-ng-class="{active: vm.isCategoryShown(category)}"><i class="icon" data-ng-class="vm.isCategoryShown(category) ? \'ion-minus\' : \'ion-plus\'"></i> &nbsp; {{category.categoryName}}</ion-item><ion-item class="item-accordion" data-ng-repeat="product in category.products" data-ng-show="vm.isCategoryShown(category)">{{product.productName}}</ion-item></div></ion-list></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/reports.html",'<ion-view view-title="Отчеты"><ion-content><ion-list><ion-item ng-repeat="playlist in playlists" href="#/app/playlists/{{playlist.id}}">{{playlist.title}}</ion-item></ion-list></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/settings.html",'<ion-view view-title="Настройки"><ion-content><h1>Настройки</h1></ion-content></ion-view>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/shell.html",'<ion-side-menus enable-menu-with-back-views="false"><ion-side-menu-content><ion-nav-bar class="bar-stable"><ion-nav-back-button></ion-nav-back-button><ion-nav-buttons side="left"><button class="button button-icon button-clear ion-navicon" menu-toggle="left"></button></ion-nav-buttons></ion-nav-bar><ion-nav-view></ion-nav-view></ion-side-menu-content><ion-side-menu side="left"><ion-header-bar class="bar-stable"><h1 class="title">Kart</h1></ion-header-bar><ion-content><ion-list><ion-item menu-close href="" data-ui-sref="app.main">Главная</ion-item><ion-item menu-close href="" data-ui-sref="app.products">Продукты</ion-item><ion-item menu-close href="" data-ui-sref="app.bills">Чеки</ion-item><ion-item menu-close href="" data-ui-sref="app.reports">Отчеты</ion-item><ion-item menu-close href="" data-ui-sref="app.stats">Статистика</ion-item><ion-item menu-close href="" data-ui-sref="app.settings">Настройки</ion-item></ion-list></ion-content></ion-side-menu></ion-side-menus>')}])}(),function(t){try{t=angular.module("app")}catch(e){t=angular.module("app",[])}t.run(["$templateCache",function(t){t.put("views/stats.html",'<ion-view view-title="Статистика"><ion-content><h1>Статистика</h1></ion-content></ion-view>')}])}()},{}]},{},[22]);